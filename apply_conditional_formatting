import pandas as pd

# Step 1: Read Excel file into DataFrame
file_path = 'path_to_your_excel_file.xlsx'
df = pd.read_excel(file_path, header=None)

# Step 2: Identify the rows where sections start
section_starts = df[0].isin(['q02', 'q03'])

# Step 3: Create DataFrames for each section
sections = []
start_idx = 0
for end_idx in section_starts[section_starts].index:
    section_df = df.iloc[start_idx:end_idx, :]
    sections.append(section_df)
    start_idx = end_idx + 1

# Step 4: Compare sections and identify unique cells
unique_cells = pd.concat([sections[0], sections[1]]).drop_duplicates(keep=False)

# Step 5: Use a styling function to update the background color of unique cells
def highlight_unique_cells(val):
    return 'background-color: yellow' if val in unique_cells.values else ''

styled_df = pd.concat([sections[0], sections[1]]).style.applymap(highlight_unique_cells)

# Display the styled DataFrame
styled_df.to_excel('output_highlighted.xlsx', engine='openpyxl', index=False)
