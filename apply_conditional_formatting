import pandas as pd

# Read Excel file into two DataFrames, one for each section
file_path = 'path_to_your_excel_file.xlsx'
df_q02 = pd.read_excel(file_path, sheet_name='q02', header=None)
df_q03 = pd.read_excel(file_path, sheet_name='q03', header=None)

# Set the first row as the header for each DataFrame
df_q02.columns = df_q02.iloc[0]
df_q03.columns = df_q03.iloc[0]

# Drop the duplicate header row
df_q02 = df_q02.iloc[1:]
df_q03 = df_q03.iloc[1:]

# Specify the columns for the join
join_columns = ['id', 'city', 'country']

# Merge or join DataFrames on the specified columns
merged_df = pd.merge(df_q02, df_q03, how='outer', on=join_columns, indicator=True).query('_merge == "right_only"').drop('_merge', axis=1)

# Apply styling to the DataFrame
def highlight_unique_cells(val):
    return 'background-color: yellow' if val in df_q03.values and val not in df_q02.values else ''

styled_df = pd.concat([df_q02, df_q03]).style.applymap(highlight_unique_cells, subset=merged_df.columns)

# Save the styled DataFrame to a new Excel file
styled_df.to_excel('output_highlighted.xlsx', engine='openpyxl', index=False)
